
<!-- README.md is generated from README.Rmd. Please edit that file -->

## Under Construction

This is a placeholder document for the work-in-progress 2022 residential
assessment model.

To see the 2021 residential assessment model, visit the
[2021-assessment-year](https://gitlab.com/ccao-data-science---modeling/models/ccao_res_avm/-/tree/2021-assessment-year)
git tag.

## Athena Guide

#### Table Universe

| Athena Table         | Observation Unit                   | Primary Key                                                                  | Notes                                                                                                                                                                               |
|:---------------------|:-----------------------------------|:-----------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| parameter_search     | model cv fold                      | year, run_id, configuration, fold_id                                         | Each row is the result from one fold assessment from one iteration                                                                                                                  |
| parameter_final      | model run                          | year, run_id                                                                 | Best hyperparameters for each run, as chosen by tune::select_best()                                                                                                                 |
| parameter_range      | parameter                          | year, run_id, parameter_name                                                 | CV search range per parameter per run                                                                                                                                               |
| assessment_card      | card                               | year, run_id, township_code, meta_pin, meta_card_num                         | Assessment results at the card level. Multi-card PINs will have more than one row. NOTE: Each run adds new partitions to S3 which must be added via a Glue crawler                  |
| assessment_pin       | pin                                | year, run_id, township_code, meta_pin                                        | Assessment results at the PIN level. Includes PIN-level stats like YoY % changes, land, sales, etc. NOTE: Each run adds new partitions to S3 which must be added via a Glue crawler |
| performance          | geography \[by class\]             | year, run_id, stage, geography_type, geography_id, by_class, class           | Peformance metrics (optionally) broken out by class for different levels of geography                                                                                               |
| performance_quantile | geography \[by class\] by quantile | year, run_id, stage, geography_type, geography_id, by_class, class, quantile | Performance metrics by quantile within class and geography                                                                                                                          |
| shap                 | card                               | year, run_id, township_code, meta_pin, meta_card_num                         | SHAP values for each feature for each card in the assessment data. NOTE: Each run adds new partitions to S3 which must be added via a Glue crawler                                  |
| metadata             | model run                          | year, run_id                                                                 | Information about each run, including parameters, ID, etc.                                                                                                                          |
| timing               | model run                          | year, run_id                                                                 | Timings for whole run. Each row represents one run, while columns represent the stages                                                                                              |

#### Run Outputs

| Athena Table         | Limited Run | Full Run          |
|:---------------------|:------------|:------------------|
| assessment_card      | No          | Yes               |
| assessment_pin       | No          | Yes               |
| metadata             | Yes         | Yes               |
| parameter_final      | Yes         | Yes               |
| parameter_range      | No          | Yes               |
| parameter_search     | No          | Yes               |
| performance          | Test only   | Test + assessment |
| performance_quantile | Test only   | Test + assessment |
| shap                 | No          | Yes               |
| timing               | Yes         | Yes               |

## Feature Guide

| Feature Name                                          | Category       | Type        | Possible Values                                                      | Notes                                                                                                                                                                                                                                                                                                                                                                                     |
|:------------------------------------------------------|:---------------|:------------|:---------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| acs5_percent_age_children                             | ACS5           | numeric     |                                                                      | Percent of the population 17 years or younger. (B01001_003E + B01001_004E + B01001_005E + B01001_006E + B01001_007E + B01001_027E + B01001_028E + B01001_029E + B01001_030E + B01001_031E) / B01001_001E                                                                                                                                                                                  |
| acs5_percent_age_senior                               | ACS5           | numeric     |                                                                      | Percent of the population 65 years or older. (B01001_020E + B01001_021E + B01001_022E + B01001_023E + B01001_024E + B01001_025E + B01001_044E + B01001_045E + B01001_046E + B01001_046E + B01001_048E + B01001_049E) / B01001_001E                                                                                                                                                        |
| acs5_median_age_total                                 | ACS5           | numeric     |                                                                      | Median age for whole population. B01002_001E                                                                                                                                                                                                                                                                                                                                              |
| acs5_percent_mobility_no_move                         | ACS5           | numeric     |                                                                      | Percent of people (older than 1 year) who have not moved in the past 12 months. B07003_004E / B07003_001E                                                                                                                                                                                                                                                                                 |
| acs5_percent_mobility_moved_from_other_state          | ACS5           | numeric     |                                                                      | Percent of people (older than 1 year) who moved from another state in the past 12 months. B07003_013E / B07003_001E                                                                                                                                                                                                                                                                       |
| acs5_percent_household_family_married                 | ACS5           | numeric     |                                                                      | Percent of households that are family, married (married). B11001_003E / B11001_001E                                                                                                                                                                                                                                                                                                       |
| acs5_percent_household_nonfamily_alone                | ACS5           | numeric     |                                                                      | Percent of households that are non-family, alone (single). B11001_008E / B11001_001E                                                                                                                                                                                                                                                                                                      |
| acs5_percent_education_high_school                    | ACS5           | numeric     |                                                                      | Percent of people older than 25 who attained a high school degree. (B15002_011E + B15002_028E) / B15002_001E                                                                                                                                                                                                                                                                              |
| acs5_percent_education_bachelor                       | ACS5           | numeric     |                                                                      | Percent of people older than 25 who attained a bachelor degree. (B15002_015E + B15002_032E) / B15002_001E                                                                                                                                                                                                                                                                                 |
| acs5_percent_education_graduate                       | ACS5           | numeric     |                                                                      | Percent of people older than 25 who attained a graduate degree. (B15002_016E + B15002_017E + B15002_018E + B15002_033E + B15002_034E + B15002_035E) / B15002_001E                                                                                                                                                                                                                         |
| acs5_percent_income_below_poverty_level               | ACS5           | numeric     |                                                                      | Percent of people below poverty level. B17001_002E / B17001_001E                                                                                                                                                                                                                                                                                                                          |
| acs5_median_income_household_past_year                | ACS5           | numeric     |                                                                      | Median income per household in the past 12 months. B19013_001E                                                                                                                                                                                                                                                                                                                            |
| acs5_median_income_per_capita_past_year               | ACS5           | numeric     |                                                                      | Median income per capita in the past 12 months. B19301_001E                                                                                                                                                                                                                                                                                                                               |
| acs5_percent_income_household_received_snap_past_year | ACS5           | numeric     |                                                                      | Percent of households that received SNAP in the past 12 months. B22003_002E / B22003_001E                                                                                                                                                                                                                                                                                                 |
| acs5_percent_employment_unemployed                    | ACS5           | numeric     |                                                                      | Percent of people 16 years and older unemployed. B23025_005E / B23025_003E                                                                                                                                                                                                                                                                                                                |
| acs5_median_household_total_occupied_year_built       | ACS5           | numeric     |                                                                      | Median year built for all occupied housing units. B25037_001E                                                                                                                                                                                                                                                                                                                             |
| acs5_median_household_renter_occupied_gross_rent      | ACS5           | numeric     |                                                                      | Median gross rent for only renter-occupied units. B25064_001E                                                                                                                                                                                                                                                                                                                             |
| acs5_median_household_owner_occupied_value            | ACS5           | numeric     |                                                                      | Median household value for only owner-occupied units. B25077_001E                                                                                                                                                                                                                                                                                                                         |
| acs5_percent_household_owner_occupied                 | ACS5           | numeric     |                                                                      | Percent of households that are owner-occupied. B25003_002E / B25003_001E                                                                                                                                                                                                                                                                                                                  |
| acs5_percent_household_total_occupied_w\_sel_cond     | ACS5           | numeric     |                                                                      | Selected conditions, including: incomplete plumbing or kitchens, overcrowding, 30% or more of the household income spent on rent or monthly owner costs. (B25123_003E + B25123_004E + B25123_005E + B25123_006E + B25123_009E + B25123_010E + B25123_011E + B25123_012E) / B25123_001E                                                                                                    |
| acs5_percent_mobility_moved_in_county                 | ACS5           | numeric     |                                                                      | Percent of people (older than 1 year) who moved in county in the past 12 months. B07003_007E / B07003_001E                                                                                                                                                                                                                                                                                |
| char_yrblt                                            | Characteristic | numeric     |                                                                      |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_air                                              | Characteristic | categorical | Central A/C, No Central A/C                                          |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_apts                                             | Characteristic | categorical | Two, Three, Four, Five, Six, None                                    | Number of apartments for class 211 and 212 properties. CAUTION: Note the numerically encoded values DO NOT correspond to the number of apartments i.e. code 1 means 2 apartments, code 6 means 0 apartments                                                                                                                                                                               |
| char_attic_fnsh                                       | Characteristic | categorical | Living Area, Partial, None                                           |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_attic_type                                       | Characteristic | categorical | Full, Partial, None                                                  |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_beds                                             | Characteristic | numeric     |                                                                      | Number of bedrooms in the building                                                                                                                                                                                                                                                                                                                                                        |
| char_bldg_sf                                          | Characteristic | numeric     |                                                                      | Square footage of the building, as measured from the exterior                                                                                                                                                                                                                                                                                                                             |
| char_bsmt                                             | Characteristic | categorical | Full, Slab, Partial, Crawl                                           |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_bsmt_fin                                         | Characteristic | categorical | Formal Rec Room, Apartment, Unfinished                               |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_ext_wall                                         | Characteristic | categorical | Frame, Masonry, Frame + Masonry, Stucco                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_fbath                                            | Characteristic | numeric     |                                                                      | Number of full bathrooms, defined as having a bath or shower. If this value is missing, the default value is set to 1                                                                                                                                                                                                                                                                     |
| char_frpl                                             | Characteristic | numeric     |                                                                      | Number of fireplaces, counted as the number of flues one can see from the outside of the building                                                                                                                                                                                                                                                                                         |
| char_gar1_area                                        | Characteristic | categorical | Yes, No                                                              | Is Garage 1 physically included within the building area? If yes, the garage area is subtracted from the building square feet calculation by the field agent                                                                                                                                                                                                                              |
| char_gar1_att                                         | Characteristic | categorical | Yes, No                                                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_gar1_cnst                                        | Characteristic | categorical | Frame, Masonry, Frame + Masonry, Stucco                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_gar1_size                                        | Characteristic | categorical | 1 cars, 1.5 cars, 2 cars, 2.5 cars, 3 cars, 3.5 cars, 0 cars, 4 cars |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_hbath                                            | Characteristic | numeric     |                                                                      | Number of half baths, defined as bathrooms without a shower or bathtub                                                                                                                                                                                                                                                                                                                    |
| char_land_sf                                          | Characteristic | numeric     |                                                                      | Square footage of the land (not just the building) of the property. Note that a single PIN can have multiple “land lines,” meaning it can be associated with more than one 200-class land lot                                                                                                                                                                                             |
| char_heat                                             | Characteristic | categorical | Warm Air Furnace, Hot Water Steam, Electric Heater, None             |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_ncu                                              | Characteristic | numeric     |                                                                      | Number of commercial units (the vast majority are for properties with class 212)                                                                                                                                                                                                                                                                                                          |
| char_porch                                            | Characteristic | categorical | None, Frame Enclosed, Masonry Enclosed                               |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_roof_cnst                                        | Characteristic | categorical | Shingle + Asphalt, Tar + Gravel, Slate, Shake, Tile, Other           |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_rooms                                            | Characteristic | numeric     |                                                                      | Number of total rooms in the building (excluding baths). Not to be confused with bedrooms                                                                                                                                                                                                                                                                                                 |
| char_tp_dsgn                                          | Characteristic | categorical | Yes, No                                                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_tp_plan                                          | Characteristic | categorical | Architect, Stock Plan                                                |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_type_resd                                        | Characteristic | categorical | 1 Story, 2 Story, 3 Story +, Split Level, 1.5 Story                  |                                                                                                                                                                                                                                                                                                                                                                                           |
| char_use                                              | Characteristic | categorical | Single-Family                                                        |                                                                                                                                                                                                                                                                                                                                                                                           |
| ind_pin_is_multicard                                  | Indicator      | logical     |                                                                      | Indicator for a PIN with more than one building (ADU, coach house, etc.)                                                                                                                                                                                                                                                                                                                  |
| ind_land_gte_95_percentile                            | Indicator      | logical     |                                                                      | Indicator for a PIN with land square footage larger than 95% of other properties for this year and township                                                                                                                                                                                                                                                                               |
| ind_bldg_gte_95_percentile                            | Indicator      | logical     |                                                                      | Indicator for a PIN with building square footage larger than 95% of other properties for this year and township                                                                                                                                                                                                                                                                           |
| ind_land_bldg_ratio_gte_10                            | Indicator      | logical     |                                                                      | Indicator for a PIN with a ratio of (land sqft / bldg sqft) of greater than or equal to 10. This is intended to identify small houses on very large lots                                                                                                                                                                                                                                  |
| loc_cook_municipality_name                            | Location       | character   |                                                                      | Municipality name for a given PIN. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                                                  |
| loc_env_flood_fema_sfha                               | Location       | logical     |                                                                      | Indicator for a PIN within a FEMA Special Flood Hazard Area. Taken from FEMA site for 2021 only                                                                                                                                                                                                                                                                                           |
| loc_env_flood_fs_factor                               | Location       | numeric     |                                                                      | First Street flood factor (risk score) for a given PIN, scores 1 - 10. Provided to the CCAO by firststreet.org                                                                                                                                                                                                                                                                            |
| loc_env_flood_fs_risk_direction                       | Location       | numeric     |                                                                      | First Street risk direction for a given PIN. Positive scores indicate increasing future flood risk, negative scores the opposite. Provided to the CCAO by firststreet.org                                                                                                                                                                                                                 |
| loc_env_ohare_noise_contour_no_buffer_bool            | Location       | logical     |                                                                      | O’Hare Airport 65 DNL noise contour, taken from oharenoise.org                                                                                                                                                                                                                                                                                                                            |
| loc_school_elementary_district_geoid                  | Location       | character   |                                                                      | Elementary school district ID for a given PIN. For CPS, elementary school attendance boundaries are used. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                           |
| loc_school_secondary_district_geoid                   | Location       | character   |                                                                      | Secondary school district ID for a given PIN. For CPS, secondary school attendance boundaries are used. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                             |
| loc_school_unified_district_geoid                     | Location       | character   |                                                                      | Unified school district ID for a given PIN. CPS is included as a unified district. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                  |
| loc_tax_special_service_area_num                      | Location       | character   |                                                                      | Tax ID of the special service area of a given PIN, if applicable. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                   |
| loc_access_cmap_walk_nta_score                        | Location       | numeric     |                                                                      | CMAP walkability score for a given PIN, excluding transit walkability. Taken from CMAP’s ON TO 2050 walkability layer                                                                                                                                                                                                                                                                     |
| loc_access_cmap_walk_total_score                      | Location       | numeric     |                                                                      | CMAP walkability score for a given PIN, including transit walkability. Taken from CMAP’s ON TO 2050 walkability layer                                                                                                                                                                                                                                                                     |
| loc_misc_subdivision_id                               | Location       | character   |                                                                      | Subdivision ID for a given PIN. Nearly all PINs are within one subdivision. Each subdivision has a unique ID with the PageSubref column. Page being the area and section and subref being the letter of that sub on a page. The subrefs go A B C D and so on, however new subs can kill old subs, so a page could have a subrefs B C G M L R S T. Each letter being a unique subdivision. |
| loc_misc_unincorporated_area_bool                     | Location       | logical     |                                                                      | Indicator for a PIN within an unincorporated part of Cook County. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                   |
| meta_township_code                                    | Meta           | character   |                                                                      | Numeric code identifying the Cook County township of a given PIN                                                                                                                                                                                                                                                                                                                          |
| meta_nbhd_code                                        | Meta           | character   |                                                                      | Assessor neighborhood. First 2 digits are township code, last 3 digits are neighborhood code                                                                                                                                                                                                                                                                                              |
| meta_tieback_proration_rate                           | Meta           | numeric     |                                                                      | Proration rate for a given PIN. Some buildings sit across multiple PINs. This number is intended to capture the split in building value                                                                                                                                                                                                                                                   |
| other_ihs_avg_year_index                              | Other          | numeric     |                                                                      | DePaul Institute of Housing Studies quarterly index, averaged up to the yearly level. Unit of observation is Census PUMAs                                                                                                                                                                                                                                                                 |
| other_tax_bill_amount_total                           | Other          | numeric     |                                                                      |                                                                                                                                                                                                                                                                                                                                                                                           |
| other_tax_bill_rate                                   | Other          | numeric     |                                                                      | Tax bill rate for the taxing district containing a given PIN. Idea is to capture any downward pressure on price from higher tax burdens                                                                                                                                                                                                                                                   |
| other_school_district_elementary_avg_rating           | Other          | numeric     |                                                                      | Average Great Schools rating of elementary schools within the district of a given PIN. For CPS, which is a unified school district, the average of schools within attendance boundary is used                                                                                                                                                                                             |
| other_school_district_secondary_avg_rating            | Other          | numeric     |                                                                      | Average Great Schools rating of secondary schools within the district of a given PIN. For CPS, which is a unified school district, the average of schools within attendance boundary is used                                                                                                                                                                                              |
| prox_num_pin_in_half_mile                             | Proximity      | numeric     |                                                                      | Number of PINs within half mile of a given PIN. Condo buildings are counted as a single PIN                                                                                                                                                                                                                                                                                               |
| prox_num_bus_stop_in_half_mile                        | Proximity      | numeric     |                                                                      | Number of bus stops (CTA or PACE) within half mile of a given PIN. Taken from GTFS feeds retrieved from transitfeeds.com                                                                                                                                                                                                                                                                  |
| prox_num_foreclosure_per_1000_pin_past_5\_years       | Proximity      | numeric     |                                                                      | Number of PIN-level foreclosure in the past 5 years, per 1000 PINs, within half mile of a given PIN. Taken from Illinois Public Records <https://public-record.com/login/>                                                                                                                                                                                                                |
| prox_num_school_in_half_mile                          | Proximity      | numeric     |                                                                      | Number of schools within half mile of a given PIN. This includes preschools, small private schools, universities, etc                                                                                                                                                                                                                                                                     |
| prox_num_school_with_rating_in_half_mile              | Proximity      | numeric     |                                                                      | Number of schools with Great Schools ratings within half mile of a given PIN                                                                                                                                                                                                                                                                                                              |
| prox_avg_school_rating_in_half_mile                   | Proximity      | numeric     |                                                                      | Average Great Schools rating for all schools (with a rating) within half mile of a given PIN. Public schools must be within the same district as the PIN to be considered in the average                                                                                                                                                                                                  |
| prox_nearest_bike_trail_dist_ft                       | Proximity      | numeric     |                                                                      | Distance in feet to the nearest bike trail (linestring). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                            |
| prox_nearest_cemetery_dist_ft                         | Proximity      | numeric     |                                                                      | Distance in feet to the nearest cemetery (polygon). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                                 |
| prox_nearest_cta_route_dist_ft                        | Proximity      | numeric     |                                                                      | Distance in feet to the nearest CTA tracks. Taken from CTA GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                      |
| prox_nearest_cta_stop_dist_ft                         | Proximity      | numeric     |                                                                      | Distance in feet to the nearest CTA stop. Taken from CTA GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                        |
| prox_nearest_hospital_dist_ft                         | Proximity      | numeric     |                                                                      | Distance in feet to the nearest hospital (polygon). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                                 |
| prox_lake_michigan_dist_ft                            | Proximity      | numeric     |                                                                      | Distance in feet to the Lake Michigan coastline. Taken from TIGER/Line coastlines file and filtered to Cook County only                                                                                                                                                                                                                                                                   |
| prox_nearest_major_road_dist_ft                       | Proximity      | numeric     |                                                                      | Distance in feet to the nearest major road/highway. Pulled via OpenStreetMap, key=highway, value=motorway,primary,trunk                                                                                                                                                                                                                                                                   |
| prox_nearest_metra_route_dist_ft                      | Proximity      | numeric     |                                                                      | Distance in feet to the nearest Metra tracks. Taken from Metra GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                  |
| prox_nearest_metra_stop_dist_ft                       | Proximity      | numeric     |                                                                      | Distance in feet to the nearest Metra stop. Taken from Metra GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                    |
| prox_nearest_park_dist_ft                             | Proximity      | numeric     |                                                                      | Distance in feet to the nearest park. Pull via OpenStreetMap, key=leisure, value=park                                                                                                                                                                                                                                                                                                     |
| prox_nearest_railroad_dist_ft                         | Proximity      | numeric     |                                                                      | Distance in feet to the nearest rail (not including CTA). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                           |
| prox_nearest_water_dist_ft                            | Proximity      | numeric     |                                                                      | Distance in feet to the nearest water, as identified by Cook County hydrology files                                                                                                                                                                                                                                                                                                       |
| time_sale_year                                        | Time           | numeric     |                                                                      | Sale year calculated as the number of years since 0 B.C.E                                                                                                                                                                                                                                                                                                                                 |
| time_sale_week                                        | Time           | numeric     |                                                                      | Sale week calculated as the number of weeks since January 1st, 1997                                                                                                                                                                                                                                                                                                                       |
| time_sale_quarter_of_year                             | Time           | character   |                                                                      | Character encoding of quarter of year (Q1 - Q4)                                                                                                                                                                                                                                                                                                                                           |
| time_sale_week_of_year                                | Time           | numeric     |                                                                      | Numeric encoding of week of year (1 - 52)                                                                                                                                                                                                                                                                                                                                                 |
| time_sale_during_school_year                          | Time           | logical     |                                                                      | Indicator for whether sale occurred during usual school year (September - May)                                                                                                                                                                                                                                                                                                            |
| time_sale_during_holidays                             | Time           | logical     |                                                                      | Indicator for whether sale occurred during holiday season (November - January)                                                                                                                                                                                                                                                                                                            |
