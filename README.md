
<!-- README.md is generated from README.Rmd. Please edit that file -->

## Under Construction

This is a placeholder document for the work-in-progress 2022 residential
assessment model.

To see the 2021 residential assessment model, visit the
[2021-assessment-year](https://gitlab.com/ccao-data-science---modeling/models/ccao_res_avm/-/tree/2021-assessment-year)
git tag.

## Athena Guide

#### Table Universe

| Athena Table         | Observation Unit                   | Primary Key                                                                  | Notes                                                                                                                                                                         |
|:---------------------|:-----------------------------------|:-----------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| metadata             | model run                          | year, run_id                                                                 | Information about each run                                                                                                                                                    |
| parameter_search     | model cv fold                      | year, run_id, configuration, fold_id                                         | Each row is the result from one fold assessment from one iteration                                                                                                            |
| parameter_final      | model run                          | year, run_id                                                                 | Best hyperparameters for each run, as chosen by tune::select_best()                                                                                                           |
| parameter_range      | parameter                          | year, run_id, parameter_name                                                 | CV search range per parameter per run                                                                                                                                         |
| assessment_card      | card                               | year, run_id, township_code, meta_pin, meta_card_num                         | Assessment results at the card level. Multi-card PINs will have more than one row. NOTE: Each run adds new partitions to S3 which must be added via a Glue crawler            |
| assessment_pin       | pin                                | year, run_id, township_code, meta_pin                                        | Assessment results at the PIN level. Includes PIN-level stats like YoY % changes, sales, etc. NOTE: Each run adds new partitions to S3 which must be added via a Glue crawler |
| performance          | geography \[by class\]             | year, run_id, stage, geography_type, geography_id, by_class, class           | Peformance metrics (optionally) broken out by class for different levels of geography                                                                                         |
| performance_quantile | geography \[by class\] by quantile | year, run_id, stage, geography_type, geography_id, by_class, class, quantile | Performance metrics by quantile within class and geography                                                                                                                    |
| shap                 | card                               | year, run_id, township_code, meta_pin, meta_card_num                         | SHAP values for each feature of each card in the assessment data. NOTE: Each run adds new partitions to S3 which must be added via a Glue crawler                             |
| timing               | model run                          | year, run_id                                                                 | Timings for whole run. Each row represents one run, while columns represent the stages                                                                                        |

#### Run Outputs

| Athena Table         | Run Type Automated | Run Type Experiment | Run Type Candidate | Run Type Final    |
|:---------------------|:-------------------|:--------------------|:-------------------|:------------------|
| metadata             | Yes                | Yes                 | Yes                | Yes               |
| parameter_search     | No                 | Yes                 | Yes                | Yes               |
| parameter_final      | Yes                | Yes                 | Yes                | Yes               |
| parameter_range      | No                 | Yes                 | Yes                | Yes               |
| assessment_card      | No                 | No                  | Yes                | Yes               |
| assessment_pin       | No                 | No                  | Yes                | Yes               |
| performance          | Test only          | Test + assessment   | Test + assessment  | Test + assessment |
| performance_quantile | Test only          | Test + assessment   | Test + assessment  | Test + assessment |
| shap                 | No                 | No                  | Yes                | Yes               |
| timing               | Yes                | Yes                 | Yes                | Yes               |

## Feature Guide

| Feature Name                                                            | Category       | Type        | Possible Values                                                      | Notes                                                                                                                                                                                                                                                                                                                                                                                     |
|:------------------------------------------------------------------------|:---------------|:------------|:---------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Percent Population Age, Under 19 Years Old                              | ACS5           | numeric     |                                                                      | Percent of the population 17 years or younger. (B01001_003E + B01001_004E + B01001_005E + B01001_006E + B01001_007E + B01001_027E + B01001_028E + B01001_029E + B01001_030E + B01001_031E) / B01001_001E                                                                                                                                                                                  |
| Percent Population Age, Over 65 Years Old                               | ACS5           | numeric     |                                                                      | Percent of the population 65 years or older. (B01001_020E + B01001_021E + B01001_022E + B01001_023E + B01001_024E + B01001_025E + B01001_044E + B01001_045E + B01001_046E + B01001_046E + B01001_048E + B01001_049E) / B01001_001E                                                                                                                                                        |
| Median Population Age                                                   | ACS5           | numeric     |                                                                      | Median age for whole population. B01002_001E                                                                                                                                                                                                                                                                                                                                              |
| Percent Population Mobility, In Same House 1 Year Ago                   | ACS5           | numeric     |                                                                      | Percent of people (older than 1 year) who have not moved in the past 12 months. B07003_004E / B07003_001E                                                                                                                                                                                                                                                                                 |
| Percent Population Mobility, Moved From Other State in Past Year        | ACS5           | numeric     |                                                                      | Percent of people (older than 1 year) who moved from another state in the past 12 months. B07003_013E / B07003_001E                                                                                                                                                                                                                                                                       |
| Percent Households Family, Married                                      | ACS5           | numeric     |                                                                      | Percent of households that are family, married (married). B11001_003E / B11001_001E                                                                                                                                                                                                                                                                                                       |
| Percent Households Nonfamily, Living Alone                              | ACS5           | numeric     |                                                                      | Percent of households that are non-family, alone (single). B11001_008E / B11001_001E                                                                                                                                                                                                                                                                                                      |
| Percent Population Education, High School Degree                        | ACS5           | numeric     |                                                                      | Percent of people older than 25 who attained a high school degree. (B15002_011E + B15002_028E) / B15002_001E                                                                                                                                                                                                                                                                              |
| Percent Population Education, Bachelor Degree                           | ACS5           | numeric     |                                                                      | Percent of people older than 25 who attained a bachelor degree. (B15002_015E + B15002_032E) / B15002_001E                                                                                                                                                                                                                                                                                 |
| Percent Population Education, Graduate Degree                           | ACS5           | numeric     |                                                                      | Percent of people older than 25 who attained a graduate degree. (B15002_016E + B15002_017E + B15002_018E + B15002_033E + B15002_034E + B15002_035E) / B15002_001E                                                                                                                                                                                                                         |
| Percent Population Income, Below Poverty Level                          | ACS5           | numeric     |                                                                      | Percent of people below poverty level. B17001_002E / B17001_001E                                                                                                                                                                                                                                                                                                                          |
| Median Income, Household in Past Year                                   | ACS5           | numeric     |                                                                      | Median income per household in the past 12 months. B19013_001E                                                                                                                                                                                                                                                                                                                            |
| Median Income, Per Capita in Past Year                                  | ACS5           | numeric     |                                                                      | Median income per capita in the past 12 months. B19301_001E                                                                                                                                                                                                                                                                                                                               |
| Percent Population Income, Received SNAP in Past Year                   | ACS5           | numeric     |                                                                      | Percent of households that received SNAP in the past 12 months. B22003_002E / B22003_001E                                                                                                                                                                                                                                                                                                 |
| Percent Population Employment, Unemployed                               | ACS5           | numeric     |                                                                      | Percent of people 16 years and older unemployed. B23025_005E / B23025_003E                                                                                                                                                                                                                                                                                                                |
| Median Occupied Household, Total, Year Built                            | ACS5           | numeric     |                                                                      | Median year built for all occupied housing units. B25037_001E                                                                                                                                                                                                                                                                                                                             |
| Median Occupied Household, Renter, Gross Rent                           | ACS5           | numeric     |                                                                      | Median gross rent for only renter-occupied units. B25064_001E                                                                                                                                                                                                                                                                                                                             |
| Median Occupied Household, Owner, Market Value                          | ACS5           | numeric     |                                                                      | Median household value for only owner-occupied units. B25077_001E                                                                                                                                                                                                                                                                                                                         |
| Percent Occupied Households, Owner                                      | ACS5           | numeric     |                                                                      | Percent of households that are owner-occupied. B25003_002E / B25003_001E                                                                                                                                                                                                                                                                                                                  |
| Percent Occupied Households, Total, One or More Selected Conditions     | ACS5           | numeric     |                                                                      | Selected conditions, including: incomplete plumbing or kitchens, overcrowding, 30% or more of the household income spent on rent or monthly owner costs. (B25123_003E + B25123_004E + B25123_005E + B25123_006E + B25123_009E + B25123_010E + B25123_011E + B25123_012E) / B25123_001E                                                                                                    |
| Percent Population Mobility, Moved From Within Same County in Past Year | ACS5           | numeric     |                                                                      | Percent of people (older than 1 year) who moved in county in the past 12 months. B07003_007E / B07003_001E                                                                                                                                                                                                                                                                                |
| Year Built                                                              | Characteristic | numeric     |                                                                      |                                                                                                                                                                                                                                                                                                                                                                                           |
| Central Air Conditioning                                                | Characteristic | categorical | Central A/C, No Central A/C                                          |                                                                                                                                                                                                                                                                                                                                                                                           |
| Apartments                                                              | Characteristic | categorical | Two, Three, Four, Five, Six, None                                    | Number of apartments for class 211 and 212 properties. CAUTION: Note the numerically encoded values DO NOT correspond to the number of apartments i.e. code 1 means 2 apartments, code 6 means 0 apartments                                                                                                                                                                               |
| Attic Finish                                                            | Characteristic | categorical | Living Area, Partial, None                                           |                                                                                                                                                                                                                                                                                                                                                                                           |
| Attic Type                                                              | Characteristic | categorical | Full, Partial, None                                                  |                                                                                                                                                                                                                                                                                                                                                                                           |
| Bedrooms                                                                | Characteristic | numeric     |                                                                      | Number of bedrooms in the building                                                                                                                                                                                                                                                                                                                                                        |
| Building Square Feet                                                    | Characteristic | numeric     |                                                                      | Square footage of the building, as measured from the exterior                                                                                                                                                                                                                                                                                                                             |
| Basement Type                                                           | Characteristic | categorical | Full, Slab, Partial, Crawl                                           |                                                                                                                                                                                                                                                                                                                                                                                           |
| Basement Finish                                                         | Characteristic | categorical | Formal Rec Room, Apartment, Unfinished                               |                                                                                                                                                                                                                                                                                                                                                                                           |
| Exterior Wall Material                                                  | Characteristic | categorical | Frame, Masonry, Frame + Masonry, Stucco                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| Full Baths                                                              | Characteristic | numeric     |                                                                      | Number of full bathrooms, defined as having a bath or shower. If this value is missing, the default value is set to 1                                                                                                                                                                                                                                                                     |
| Fireplaces                                                              | Characteristic | numeric     |                                                                      | Number of fireplaces, counted as the number of flues one can see from the outside of the building                                                                                                                                                                                                                                                                                         |
| Garage 1 Area Included                                                  | Characteristic | categorical | Yes, No                                                              | Is Garage 1 physically included within the building area? If yes, the garage area is subtracted from the building square feet calculation by the field agent                                                                                                                                                                                                                              |
| Garage 1 Attached                                                       | Characteristic | categorical | Yes, No                                                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| Garage 1 Ext. Wall Material                                             | Characteristic | categorical | Frame, Masonry, Frame + Masonry, Stucco                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| Garage 1 Size                                                           | Characteristic | categorical | 1 cars, 1.5 cars, 2 cars, 2.5 cars, 3 cars, 3.5 cars, 0 cars, 4 cars |                                                                                                                                                                                                                                                                                                                                                                                           |
| Half Baths                                                              | Characteristic | numeric     |                                                                      | Number of half baths, defined as bathrooms without a shower or bathtub                                                                                                                                                                                                                                                                                                                    |
| Land Square Feet                                                        | Characteristic | numeric     |                                                                      | Square footage of the land (not just the building) of the property. Note that a single PIN can have multiple “land lines,” meaning it can be associated with more than one 200-class land lot                                                                                                                                                                                             |
| Central Heating                                                         | Characteristic | categorical | Warm Air Furnace, Hot Water Steam, Electric Heater, None             |                                                                                                                                                                                                                                                                                                                                                                                           |
| Number of Commercial Units                                              | Characteristic | numeric     |                                                                      | Number of commercial units (the vast majority are for properties with class 212)                                                                                                                                                                                                                                                                                                          |
| Porch                                                                   | Characteristic | categorical | None, Frame Enclosed, Masonry Enclosed                               |                                                                                                                                                                                                                                                                                                                                                                                           |
| Roof Material                                                           | Characteristic | categorical | Shingle + Asphalt, Tar + Gravel, Slate, Shake, Tile, Other           |                                                                                                                                                                                                                                                                                                                                                                                           |
| Rooms                                                                   | Characteristic | numeric     |                                                                      | Number of total rooms in the building (excluding baths). Not to be confused with bedrooms                                                                                                                                                                                                                                                                                                 |
| Cathedral Ceiling                                                       | Characteristic | categorical | Yes, No                                                              |                                                                                                                                                                                                                                                                                                                                                                                           |
| Design Plan                                                             | Characteristic | categorical | Architect, Stock Plan                                                |                                                                                                                                                                                                                                                                                                                                                                                           |
| Type of Residence                                                       | Characteristic | categorical | 1 Story, 2 Story, 3 Story +, Split Level, 1.5 Story                  |                                                                                                                                                                                                                                                                                                                                                                                           |
| Single vs. Multi-family Use                                             | Characteristic | categorical | Single-Family                                                        |                                                                                                                                                                                                                                                                                                                                                                                           |
| Single vs. Multi-family Use                                             | Characteristic | categorical | Multi-Family                                                         | Categorical variable for single- vs multi-family dwellings                                                                                                                                                                                                                                                                                                                                |
| Multicard PIN                                                           | Indicator      | logical     |                                                                      | Indicator for a PIN with more than one building (ADU, coach house, etc.)                                                                                                                                                                                                                                                                                                                  |
| Land Square Feet Greater Than or Equal to 95th Percentile               | Indicator      | logical     |                                                                      | Indicator for a PIN with land square footage larger than 95% of other properties for this year and township                                                                                                                                                                                                                                                                               |
| Land Square Feet Greater Than or Equal to 95th Percentile               | Indicator      | logical     |                                                                      | Indicator for a PIN with building square footage larger than 95% of other properties for this year and township                                                                                                                                                                                                                                                                           |
| Land to Building Square Footage Ratio Greater Than or Equal to 10       | Indicator      | logical     |                                                                      | Indicator for a PIN with a ratio of (land sqft / bldg sqft) of greater than or equal to 10. This is intended to identify small houses on very large lots                                                                                                                                                                                                                                  |
| Municipality Name                                                       | Location       | character   |                                                                      | Municipality name for a given PIN. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                                                  |
| FEMA Special Flood Hazard Area                                          | Location       | logical     |                                                                      | Indicator for a PIN within a FEMA Special Flood Hazard Area. Taken from FEMA site for 2021 only                                                                                                                                                                                                                                                                                           |
| First Street Factor                                                     | Location       | numeric     |                                                                      | First Street flood factor (risk score) for a given PIN, scores 1 - 10. Provided to the CCAO by firststreet.org                                                                                                                                                                                                                                                                            |
| First Street Risk Direction                                             | Location       | numeric     |                                                                      | First Street risk direction for a given PIN. Positive scores indicate increasing future flood risk, negative scores the opposite. Provided to the CCAO by firststreet.org                                                                                                                                                                                                                 |
| O’Hare Noise Contour No Buffer Boolean                                  | Location       | logical     |                                                                      | O’Hare Airport 65 DNL noise contour, taken from oharenoise.org                                                                                                                                                                                                                                                                                                                            |
| School Elementary District GEOID                                        | Location       | character   |                                                                      | Elementary school district ID for a given PIN. For CPS, elementary school attendance boundaries are used. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                           |
| School Secondary District GEOID                                         | Location       | character   |                                                                      | Secondary school district ID for a given PIN. For CPS, secondary school attendance boundaries are used. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                             |
| School Unified District GEOID                                           | Location       | character   |                                                                      | Unified school district ID for a given PIN. CPS is included as a unified district. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                  |
| Special Service Area Number                                             | Location       | character   |                                                                      | Tax ID of the special service area of a given PIN, if applicable. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                   |
| CMAP Walkability Score (No Transit)                                     | Location       | numeric     |                                                                      | CMAP walkability score for a given PIN, excluding transit walkability. Taken from CMAP’s ON TO 2050 walkability layer                                                                                                                                                                                                                                                                     |
| CMAP Walkability Total Score                                            | Location       | numeric     |                                                                      | CMAP walkability score for a given PIN, including transit walkability. Taken from CMAP’s ON TO 2050 walkability layer                                                                                                                                                                                                                                                                     |
| Subdivision ID                                                          | Location       | character   |                                                                      | Subdivision ID for a given PIN. Nearly all PINs are within one subdivision. Each subdivision has a unique ID with the PageSubref column. Page being the area and section and subref being the letter of that sub on a page. The subrefs go A B C D and so on, however new subs can kill old subs, so a page could have a subrefs B C G M L R S T. Each letter being a unique subdivision. |
| Unincorporated Area Boolean                                             | Location       | logical     |                                                                      | Indicator for a PIN within an unincorporated part of Cook County. Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                   |
| Township Code                                                           | Meta           | character   |                                                                      | Numeric code identifying the Cook County township of a given PIN                                                                                                                                                                                                                                                                                                                          |
| Neighborhood Code                                                       | Meta           | character   |                                                                      | Assessor neighborhood. First 2 digits are township code, last 3 digits are neighborhood code                                                                                                                                                                                                                                                                                              |
| Tieback Proration Rate                                                  | Meta           | numeric     |                                                                      | Proration rate for a given PIN. Some buildings sit across multiple PINs. This number is intended to capture the split in building value                                                                                                                                                                                                                                                   |
| DePaul IHS Average Year Index                                           | Other          | numeric     |                                                                      | DePaul Institute of Housing Studies quarterly index, averaged up to the yearly level. Unit of observation is Census PUMAs                                                                                                                                                                                                                                                                 |
| Property Tax Bill Amount Total                                          | Other          | numeric     |                                                                      |                                                                                                                                                                                                                                                                                                                                                                                           |
| Property Tax Bill Aggregate Rate                                        | Other          | numeric     |                                                                      | Tax bill rate for the taxing district containing a given PIN. Idea is to capture any downward pressure on price from higher tax burdens                                                                                                                                                                                                                                                   |
| School District (Elementary) GreatSchools Rating                        | Other          | numeric     |                                                                      | Average Great Schools rating of elementary schools within the district of a given PIN. For CPS, which is a unified school district, the average of schools within attendance boundary is used                                                                                                                                                                                             |
| School District (Secondary) GreatSchools Rating                         | Other          | numeric     |                                                                      | Average Great Schools rating of secondary schools within the district of a given PIN. For CPS, which is a unified school district, the average of schools within attendance boundary is used                                                                                                                                                                                              |
| Number of PINs in Half Mile                                             | Proximity      | numeric     |                                                                      | Number of PINs within half mile of a given PIN. Condo buildings are counted as a single PIN                                                                                                                                                                                                                                                                                               |
| Number of Bus Stops in Half Mile                                        | Proximity      | numeric     |                                                                      | Number of bus stops (CTA or PACE) within half mile of a given PIN. Taken from GTFS feeds retrieved from transitfeeds.com                                                                                                                                                                                                                                                                  |
| Number of Foreclosures Per 1000 PINs (Past 5 Years)                     | Proximity      | numeric     |                                                                      | Number of PIN-level foreclosure in the past 5 years, per 1000 PINs, within half mile of a given PIN. Taken from Illinois Public Records <https://public-record.com/login/>                                                                                                                                                                                                                |
| Number of Schools in Half Mile                                          | Proximity      | numeric     |                                                                      | Number of schools within half mile of a given PIN. This includes preschools, small private schools, universities, etc                                                                                                                                                                                                                                                                     |
| Number of Schools with Rating in Half Mile                              | Proximity      | numeric     |                                                                      | Number of schools with Great Schools ratings within half mile of a given PIN                                                                                                                                                                                                                                                                                                              |
| Average School Rating in Half Mile                                      | Proximity      | numeric     |                                                                      | Average Great Schools rating for all schools (with a rating) within half mile of a given PIN. Public schools must be within the same district as the PIN to be considered in the average                                                                                                                                                                                                  |
| Nearest Bike Trail Distance (Feet)                                      | Proximity      | numeric     |                                                                      | Distance in feet to the nearest bike trail (linestring). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                            |
| Nearest Cemetery Distance (Feet)                                        | Proximity      | numeric     |                                                                      | Distance in feet to the nearest cemetery (polygon). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                                 |
| Nearest CTA Route Distance (Feet)                                       | Proximity      | numeric     |                                                                      | Distance in feet to the nearest CTA tracks. Taken from CTA GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                      |
| Nearest CTA Stop Distance (Feet)                                        | Proximity      | numeric     |                                                                      | Distance in feet to the nearest CTA stop. Taken from CTA GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                        |
| Nearest Hospital Distance (Feet)                                        | Proximity      | numeric     |                                                                      | Distance in feet to the nearest hospital (polygon). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                                 |
| Lake Michigan Distance (Feet)                                           | Proximity      | numeric     |                                                                      | Distance in feet to the Lake Michigan coastline. Taken from TIGER/Line coastlines file and filtered to Cook County only                                                                                                                                                                                                                                                                   |
| Nearest Major Road Distance (Feet)                                      | Proximity      | numeric     |                                                                      | Distance in feet to the nearest major road/highway. Pulled via OpenStreetMap, key=highway, value=motorway,primary,trunk                                                                                                                                                                                                                                                                   |
| Nearest Metra Route Distance (Feet)                                     | Proximity      | numeric     |                                                                      | Distance in feet to the nearest Metra tracks. Taken from Metra GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                  |
| Nearest Metra Stop Distance (Feet)                                      | Proximity      | numeric     |                                                                      | Distance in feet to the nearest Metra stop. Taken from Metra GTFS feeds retrieved via transitfeeds.com                                                                                                                                                                                                                                                                                    |
| Nearest Park Distance (Feet)                                            | Proximity      | numeric     |                                                                      | Distance in feet to the nearest park. Pull via OpenStreetMap, key=leisure, value=park                                                                                                                                                                                                                                                                                                     |
| Nearest Railroad Distance (Feet)                                        | Proximity      | numeric     |                                                                      | Distance in feet to the nearest rail (not including CTA). Taken from Cook County GIS shapefiles                                                                                                                                                                                                                                                                                           |
| Nearest Water Distance (Feet)                                           | Proximity      | numeric     |                                                                      | Distance in feet to the nearest water, as identified by Cook County hydrology files                                                                                                                                                                                                                                                                                                       |
| Sale Year                                                               | Time           | numeric     |                                                                      | Sale year calculated as the number of years since 0 B.C.E                                                                                                                                                                                                                                                                                                                                 |
| Sale Week                                                               | Time           | numeric     |                                                                      | Sale week calculated as the number of weeks since January 1st, 1997                                                                                                                                                                                                                                                                                                                       |
| Sale Quarter of Year                                                    | Time           | character   |                                                                      | Character encoding of quarter of year (Q1 - Q4)                                                                                                                                                                                                                                                                                                                                           |
| Sale Week of Year                                                       | Time           | numeric     |                                                                      | Numeric encoding of week of year (1 - 52)                                                                                                                                                                                                                                                                                                                                                 |
| Sale During School Year                                                 | Time           | logical     |                                                                      | Indicator for whether sale occurred during usual school year (September - May)                                                                                                                                                                                                                                                                                                            |
| Sale During Holidays                                                    | Time           | logical     |                                                                      | Indicator for whether sale occurred during holiday season (November - January)                                                                                                                                                                                                                                                                                                            |
