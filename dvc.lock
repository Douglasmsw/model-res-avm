schema: '2.0'
stages:
  ingest:
    cmd: Rscript pipeline/00-ingest.R
    params:
      params.yaml:
        assessment:
          year: '2022'
          date: '2022-01-01'
          triad: north
          group: residential
          data_year: '2021'
        input:
          min_sale_year: '2015'
          max_sale_year: '2021'
          complex:
            match_exact:
            - meta_township_code
            - meta_class
            - char_bsmt
            - char_gar1_size
            - char_attic_fnsh
            - char_beds
            match_fuzzy:
              rooms: 1
              bldg_sf: 25
              yrblt: 4
              dist_ft: 250
    outs:
    - path: input/assessment_data.parquet
      md5: 27af7eb106b52fe3f71983158321f0a1
      size: 284493350
    - path: input/complex_id_data.parquet
      md5: 765e3dd2ff57b06e225240195b2641f7
      size: 718735
    - path: input/land_nbhd_rate_data.parquet
      md5: ec62f0ca2657094de5cfc4237da63deb
      size: 3610
    - path: input/land_site_rate_data.parquet
      md5: f13077e733fc54a8adfa8c85775468ac
      size: 197096
    - path: input/training_data.parquet
      md5: 7d8b4e0c4e62311d302efe94ce81fbd1
      size: 100602440
  train:
    cmd: Rscript pipeline/01-train.R
    deps:
    - path: input/training_data.parquet
      md5: 7d8b4e0c4e62311d302efe94ce81fbd1
      size: 100602440
    params:
      params.yaml:
        cv:
          split_prop: 0.8
          num_folds: 10
          initial_set: 16
          max_iterations: 50
          no_improve: 12
          best_metric: rmse
        model.engine: lightgbm
        model.hyperparameter:
          default:
            stop_iter: 14
            num_leaves: 4270
            add_to_linked_depth: 2
            feature_fraction: 0.4120287037454545
            max_cat_threshold: 206
            min_data_per_group: 96
            lambda_l1: 0.48360347165103584
            max_depth: 14
            max_bin: 981
          range:
            stop_iter:
            - 5
            - 30
            num_leaves:
            - 500
            - 6000
            add_to_linked_depth:
            - 1
            - 3
            feature_fraction:
            - 0.3
            - 1.0
            max_cat_threshold:
            - 20
            - 250
            min_data_per_group:
            - 20
            - 250
            lambda_l1:
            - -3
            - 2
            max_depth:
            - 4
            - 16
            max_bin:
            - 50
            - 1200
        model.objective: rmse
        model.parameter:
          num_iterations: 1000
          learning_rate: 0.1
          validation_prop: 0.1
          validation_metric: rmse
          link_max_depth: true
        model.predictor:
          all:
          - meta_township_code
          - meta_nbhd_code
          - meta_tieback_proration_rate
          - char_yrblt
          - char_air
          - char_apts
          - char_attic_fnsh
          - char_attic_type
          - char_beds
          - char_bldg_sf
          - char_bsmt
          - char_bsmt_fin
          - char_ext_wall
          - char_fbath
          - char_frpl
          - char_gar1_area
          - char_gar1_att
          - char_gar1_cnst
          - char_gar1_size
          - char_hbath
          - char_land_sf
          - char_heat
          - char_ncu
          - char_porch
          - char_roof_cnst
          - char_rooms
          - char_tp_dsgn
          - char_tp_plan
          - char_type_resd
          - char_use
          - loc_longitude
          - loc_latitude
          - loc_cook_municipality_name
          - loc_env_flood_fema_sfha
          - loc_env_flood_fs_factor
          - loc_env_flood_fs_risk_direction
          - loc_env_ohare_noise_contour_no_buffer_bool
          - loc_school_elementary_district_geoid
          - loc_school_secondary_district_geoid
          - loc_school_unified_district_geoid
          - loc_tax_special_service_area_num
          - loc_access_cmap_walk_nta_score
          - loc_access_cmap_walk_total_score
          - loc_misc_subdivision_id
          - loc_misc_unincorporated_area_bool
          - prox_num_pin_in_half_mile
          - prox_num_bus_stop_in_half_mile
          - prox_num_foreclosure_per_1000_pin_past_5_years
          - prox_num_school_in_half_mile
          - prox_num_school_with_rating_in_half_mile
          - prox_avg_school_rating_in_half_mile
          - prox_nearest_bike_trail_dist_ft
          - prox_nearest_cemetery_dist_ft
          - prox_nearest_cta_route_dist_ft
          - prox_nearest_cta_stop_dist_ft
          - prox_nearest_hospital_dist_ft
          - prox_lake_michigan_dist_ft
          - prox_nearest_major_road_dist_ft
          - prox_nearest_metra_route_dist_ft
          - prox_nearest_metra_stop_dist_ft
          - prox_nearest_park_dist_ft
          - prox_nearest_railroad_dist_ft
          - prox_nearest_water_dist_ft
          - acs5_percent_age_children
          - acs5_percent_age_senior
          - acs5_median_age_total
          - acs5_percent_mobility_no_move
          - acs5_percent_mobility_moved_from_other_state
          - acs5_percent_household_family_married
          - acs5_percent_household_nonfamily_alone
          - acs5_percent_education_high_school
          - acs5_percent_education_bachelor
          - acs5_percent_education_graduate
          - acs5_percent_income_below_poverty_level
          - acs5_median_income_household_past_year
          - acs5_median_income_per_capita_past_year
          - acs5_percent_income_household_received_snap_past_year
          - acs5_percent_employment_unemployed
          - acs5_median_household_total_occupied_year_built
          - acs5_median_household_renter_occupied_gross_rent
          - acs5_median_household_owner_occupied_value
          - acs5_percent_household_owner_occupied
          - acs5_percent_household_total_occupied_w_sel_cond
          - acs5_percent_mobility_moved_in_county
          - other_ihs_avg_year_index
          - other_tax_bill_rate
          - other_school_district_elementary_avg_rating
          - other_school_district_secondary_avg_rating
          - time_sale_year
          - time_sale_day
          - time_sale_quarter_of_year
          - time_sale_day_of_year
          - ind_pin_is_multicard
          categorical:
          - meta_township_code
          - meta_nbhd_code
          - char_air
          - char_apts
          - char_attic_fnsh
          - char_attic_type
          - char_bsmt
          - char_bsmt_fin
          - char_ext_wall
          - char_gar1_area
          - char_gar1_att
          - char_gar1_cnst
          - char_gar1_size
          - char_heat
          - char_porch
          - char_roof_cnst
          - char_tp_dsgn
          - char_tp_plan
          - char_type_resd
          - char_use
          - loc_cook_municipality_name
          - loc_school_elementary_district_geoid
          - loc_school_secondary_district_geoid
          - loc_school_unified_district_geoid
          - loc_tax_special_service_area_num
          - loc_misc_subdivision_id
          - time_sale_quarter_of_year
          id:
          - meta_year
          - meta_pin
          - meta_class
          - meta_card_num
          - meta_sale_document_num
        model.seed: 20220117
        model.verbose: -1
        ratio_study:
          far_year: '2019'
          far_stage: board
          far_column: meta_2yr_pri_board_tot
          near_year: '2021'
          near_stage: mailed
          near_column: meta_mailed_tot
          num_quantile:
          - 3
          - 5
          - 10
        toggle.cv_enable: true
    outs:
    - path: output/intermediate/timing/model_timing_train.parquet
      md5: 5092a96311cc16b6f859fade617b31cc
      size: 2331
    - path: output/parameter_final/model_parameter_final.parquet
      md5: 773c3ec327aa5aa7534ed914dad276fc
      size: 6210
    - path: output/parameter_range/model_parameter_range.parquet
      md5: 397888e306e5560478f716c8e5589209
      size: 1877
    - path: output/parameter_search/model_parameter_search.parquet
      md5: 5a8a577b5db3989b732ea10bb98066a3
      size: 92685
    - path: output/test_card/model_test_card.parquet
      md5: e988e061a0db5b80d0bd856230761f68
      size: 3213903
    - path: output/workflow/fit/model_workflow_fit.zip
      md5: 3ced23f92078961afd55568951fea756
      size: 35274194
    - path: output/workflow/recipe/model_workflow_recipe.rds
      md5: b22024034f656135f147b5f18a0c1035
      size: 1928861
  assess:
    cmd: Rscript pipeline/02-assess.R
    deps:
    - path: input/assessment_data.parquet
      md5: 27af7eb106b52fe3f71983158321f0a1
      size: 284493350
    - path: input/complex_id_data.parquet
      md5: 765e3dd2ff57b06e225240195b2641f7
      size: 718735
    - path: input/land_nbhd_rate_data.parquet
      md5: ec62f0ca2657094de5cfc4237da63deb
      size: 3610
    - path: input/land_site_rate_data.parquet
      md5: f13077e733fc54a8adfa8c85775468ac
      size: 197096
    - path: input/training_data.parquet
      md5: 7d8b4e0c4e62311d302efe94ce81fbd1
      size: 100602440
    - path: output/workflow/fit/model_workflow_fit.zip
      md5: 3ced23f92078961afd55568951fea756
      size: 35274194
    - path: output/workflow/recipe/model_workflow_recipe.rds
      md5: b22024034f656135f147b5f18a0c1035
      size: 1928861
    params:
      params.yaml:
        assessment:
          year: '2022'
          date: '2022-01-01'
          triad: north
          group: residential
          data_year: '2021'
        model.predictor.all:
        - meta_township_code
        - meta_nbhd_code
        - meta_tieback_proration_rate
        - char_yrblt
        - char_air
        - char_apts
        - char_attic_fnsh
        - char_attic_type
        - char_beds
        - char_bldg_sf
        - char_bsmt
        - char_bsmt_fin
        - char_ext_wall
        - char_fbath
        - char_frpl
        - char_gar1_area
        - char_gar1_att
        - char_gar1_cnst
        - char_gar1_size
        - char_hbath
        - char_land_sf
        - char_heat
        - char_ncu
        - char_porch
        - char_roof_cnst
        - char_rooms
        - char_tp_dsgn
        - char_tp_plan
        - char_type_resd
        - char_use
        - loc_longitude
        - loc_latitude
        - loc_cook_municipality_name
        - loc_env_flood_fema_sfha
        - loc_env_flood_fs_factor
        - loc_env_flood_fs_risk_direction
        - loc_env_ohare_noise_contour_no_buffer_bool
        - loc_school_elementary_district_geoid
        - loc_school_secondary_district_geoid
        - loc_school_unified_district_geoid
        - loc_tax_special_service_area_num
        - loc_access_cmap_walk_nta_score
        - loc_access_cmap_walk_total_score
        - loc_misc_subdivision_id
        - loc_misc_unincorporated_area_bool
        - prox_num_pin_in_half_mile
        - prox_num_bus_stop_in_half_mile
        - prox_num_foreclosure_per_1000_pin_past_5_years
        - prox_num_school_in_half_mile
        - prox_num_school_with_rating_in_half_mile
        - prox_avg_school_rating_in_half_mile
        - prox_nearest_bike_trail_dist_ft
        - prox_nearest_cemetery_dist_ft
        - prox_nearest_cta_route_dist_ft
        - prox_nearest_cta_stop_dist_ft
        - prox_nearest_hospital_dist_ft
        - prox_lake_michigan_dist_ft
        - prox_nearest_major_road_dist_ft
        - prox_nearest_metra_route_dist_ft
        - prox_nearest_metra_stop_dist_ft
        - prox_nearest_park_dist_ft
        - prox_nearest_railroad_dist_ft
        - prox_nearest_water_dist_ft
        - acs5_percent_age_children
        - acs5_percent_age_senior
        - acs5_median_age_total
        - acs5_percent_mobility_no_move
        - acs5_percent_mobility_moved_from_other_state
        - acs5_percent_household_family_married
        - acs5_percent_household_nonfamily_alone
        - acs5_percent_education_high_school
        - acs5_percent_education_bachelor
        - acs5_percent_education_graduate
        - acs5_percent_income_below_poverty_level
        - acs5_median_income_household_past_year
        - acs5_median_income_per_capita_past_year
        - acs5_percent_income_household_received_snap_past_year
        - acs5_percent_employment_unemployed
        - acs5_median_household_total_occupied_year_built
        - acs5_median_household_renter_occupied_gross_rent
        - acs5_median_household_owner_occupied_value
        - acs5_percent_household_owner_occupied
        - acs5_percent_household_total_occupied_w_sel_cond
        - acs5_percent_mobility_moved_in_county
        - other_ihs_avg_year_index
        - other_tax_bill_rate
        - other_school_district_elementary_avg_rating
        - other_school_district_secondary_avg_rating
        - time_sale_year
        - time_sale_day
        - time_sale_quarter_of_year
        - time_sale_day_of_year
        - ind_pin_is_multicard
        pv:
          multicard_yoy_cap: 2.0
          land_pct_of_total_cap: 0.5
          round_break:
          - 10000
          round_to_nearest:
          - 100
          - 500
          round_type: ceiling
        ratio_study:
          far_year: '2019'
          far_stage: board
          far_column: meta_2yr_pri_board_tot
          near_year: '2021'
          near_stage: mailed
          near_column: meta_mailed_tot
          num_quantile:
          - 3
          - 5
          - 10
    outs:
    - path: output/assessment_card/model_assessment_card.parquet
      md5: 51771caea02257f66925131e08bc347c
      size: 211433193
    - path: output/assessment_pin/model_assessment_pin.parquet
      md5: 76d3553c715d5a8e4abbcf912e020508
      size: 104409128
    - path: output/intermediate/timing/model_timing_assess.parquet
      md5: 75901db7bb463746275a9c550fd06f0f
      size: 2338
  evaluate:
    cmd: Rscript pipeline/03-evaluate.R
    deps:
    - path: output/assessment_pin/model_assessment_pin.parquet
      md5: 76d3553c715d5a8e4abbcf912e020508
      size: 104409128
    - path: output/test_card/model_test_card.parquet
      md5: e988e061a0db5b80d0bd856230761f68
      size: 3213903
    params:
      params.yaml:
        assessment.data_year: '2021'
        ratio_study:
          far_year: '2019'
          far_stage: board
          far_column: meta_2yr_pri_board_tot
          near_year: '2021'
          near_stage: mailed
          near_column: meta_mailed_tot
          num_quantile:
          - 3
          - 5
          - 10
        run_type: full
    outs:
    - path: output/intermediate/timing/model_timing_evaluate.parquet
      md5: 27b345928cb55fab9b3de44dab225f1e
      size: 2352
    - path: output/performance/model_performance_assessment.parquet
      md5: 15beffad33b8d14c1a99d677f0dc3ed0
      size: 12660159
    - path: output/performance/model_performance_test.parquet
      md5: c35e6052de0a81a473f76010fa5af0dd
      size: 9978113
    - path: output/performance_quantile/model_performance_quantile_assessment.parquet
      md5: c9189e37cd6a4d396eb0d6c61f804aea
      size: 5055106
    - path: output/performance_quantile/model_performance_quantile_test.parquet
      md5: 74413d795a3e5223961f59a9e85e73db
      size: 6102550
  interpret:
    cmd: Rscript pipeline/04-interpret.R
    deps:
    - path: input/assessment_data.parquet
      md5: 27af7eb106b52fe3f71983158321f0a1
      size: 284493350
    - path: output/workflow/fit/model_workflow_fit.zip
      md5: 3ced23f92078961afd55568951fea756
      size: 35274194
    - path: output/workflow/recipe/model_workflow_recipe.rds
      md5: b22024034f656135f147b5f18a0c1035
      size: 1928861
    params:
      params.yaml:
        model.predictor.all:
        - meta_township_code
        - meta_nbhd_code
        - meta_tieback_proration_rate
        - char_yrblt
        - char_air
        - char_apts
        - char_attic_fnsh
        - char_attic_type
        - char_beds
        - char_bldg_sf
        - char_bsmt
        - char_bsmt_fin
        - char_ext_wall
        - char_fbath
        - char_frpl
        - char_gar1_area
        - char_gar1_att
        - char_gar1_cnst
        - char_gar1_size
        - char_hbath
        - char_land_sf
        - char_heat
        - char_ncu
        - char_porch
        - char_roof_cnst
        - char_rooms
        - char_tp_dsgn
        - char_tp_plan
        - char_type_resd
        - char_use
        - loc_longitude
        - loc_latitude
        - loc_cook_municipality_name
        - loc_env_flood_fema_sfha
        - loc_env_flood_fs_factor
        - loc_env_flood_fs_risk_direction
        - loc_env_ohare_noise_contour_no_buffer_bool
        - loc_school_elementary_district_geoid
        - loc_school_secondary_district_geoid
        - loc_school_unified_district_geoid
        - loc_tax_special_service_area_num
        - loc_access_cmap_walk_nta_score
        - loc_access_cmap_walk_total_score
        - loc_misc_subdivision_id
        - loc_misc_unincorporated_area_bool
        - prox_num_pin_in_half_mile
        - prox_num_bus_stop_in_half_mile
        - prox_num_foreclosure_per_1000_pin_past_5_years
        - prox_num_school_in_half_mile
        - prox_num_school_with_rating_in_half_mile
        - prox_avg_school_rating_in_half_mile
        - prox_nearest_bike_trail_dist_ft
        - prox_nearest_cemetery_dist_ft
        - prox_nearest_cta_route_dist_ft
        - prox_nearest_cta_stop_dist_ft
        - prox_nearest_hospital_dist_ft
        - prox_lake_michigan_dist_ft
        - prox_nearest_major_road_dist_ft
        - prox_nearest_metra_route_dist_ft
        - prox_nearest_metra_stop_dist_ft
        - prox_nearest_park_dist_ft
        - prox_nearest_railroad_dist_ft
        - prox_nearest_water_dist_ft
        - acs5_percent_age_children
        - acs5_percent_age_senior
        - acs5_median_age_total
        - acs5_percent_mobility_no_move
        - acs5_percent_mobility_moved_from_other_state
        - acs5_percent_household_family_married
        - acs5_percent_household_nonfamily_alone
        - acs5_percent_education_high_school
        - acs5_percent_education_bachelor
        - acs5_percent_education_graduate
        - acs5_percent_income_below_poverty_level
        - acs5_median_income_household_past_year
        - acs5_median_income_per_capita_past_year
        - acs5_percent_income_household_received_snap_past_year
        - acs5_percent_employment_unemployed
        - acs5_median_household_total_occupied_year_built
        - acs5_median_household_renter_occupied_gross_rent
        - acs5_median_household_owner_occupied_value
        - acs5_percent_household_owner_occupied
        - acs5_percent_household_total_occupied_w_sel_cond
        - acs5_percent_mobility_moved_in_county
        - other_ihs_avg_year_index
        - other_tax_bill_rate
        - other_school_district_elementary_avg_rating
        - other_school_district_secondary_avg_rating
        - time_sale_year
        - time_sale_day
        - time_sale_quarter_of_year
        - time_sale_day_of_year
        - ind_pin_is_multicard
    outs:
    - path: output/intermediate/timing/model_timing_interpret.parquet
      md5: 5d7322f23860274b3592ddeb2f8a2274
      size: 2359
    - path: output/shap/model_shap.parquet
      md5: 301be97b31b9aa222ff5c7560ed57404
      size: 844977307
  finalize:
    cmd: Rscript pipeline/05-finalize.R
    deps:
    - path: output/assessment_card/model_assessment_card.parquet
      md5: 74f18cb13e41c5bd78c83dab9cb9f8cf
      size: 211428114
    - path: output/assessment_pin/model_assessment_pin.parquet
      md5: fffa7380cd93420db3e13e3128d96ab9
      size: 104093553
    - path: output/intermediate/timing/model_timing_assess.parquet
      md5: 08371bf96428aed2ad59d6758f370da4
      size: 2338
    - path: output/intermediate/timing/model_timing_evaluate.parquet
      md5: 26881ebc221dd8a1e89d162c2cef3112
      size: 2352
    - path: output/intermediate/timing/model_timing_interpret.parquet
      md5: c099f043260a8f79d123b0edc56c8a84
      size: 2359
    - path: output/intermediate/timing/model_timing_train.parquet
      md5: f10cfa32c106f5f7e1436603623e58dc
      size: 2331
    - path: output/parameter_final/model_parameter_final.parquet
      md5: 334335ea976aae4d4806d858af9adb5e
      size: 6199
    - path: output/parameter_range/model_parameter_range.parquet
      md5: 397888e306e5560478f716c8e5589209
      size: 1877
    - path: output/parameter_search/model_parameter_search.parquet
      md5: 5683844dfa6d8df20909b91c82b89a4d
      size: 93388
    - path: output/performance/model_performance_assessment.parquet
      md5: 84c507bc07daa000e67f71027bd8d420
      size: 12648187
    - path: output/performance/model_performance_test.parquet
      md5: fd537ccfacb934e9b0bb500642c364f9
      size: 9982865
    - path: output/performance_quantile/model_performance_quantile_assessment.parquet
      md5: 5b10189c3fecba10cf6e2f9f03829225
      size: 5044496
    - path: output/performance_quantile/model_performance_quantile_test.parquet
      md5: f896e55f0a4ed3f01e526f8ed5e39d96
      size: 6110342
    - path: output/shap/model_shap.parquet
      md5: 348576b98b6650191a77b12c221847ef
      size: 837266206
    - path: output/test_card/model_test_card.parquet
      md5: ecd72e26f29468c1df9c4afd40eebe49
      size: 3213831
    - path: output/workflow/fit/model_workflow_fit.zip
      md5: 222f7a8f06bad0d9efdb3283407f0e06
      size: 11200368
    - path: output/workflow/recipe/model_workflow_recipe.rds
      md5: b22024034f656135f147b5f18a0c1035
      size: 1928861
    params:
      params.yaml:
        cv:
          split_prop: 0.8
          num_folds: 10
          initial_set: 16
          max_iterations: 50
          no_improve: 12
          best_metric: mae
        input:
          min_sale_year: '2015'
          max_sale_year: '2021'
          complex:
            match_exact:
            - meta_township_code
            - meta_class
            - char_bsmt
            - char_gar1_size
            - char_attic_fnsh
            - char_beds
            match_fuzzy:
              rooms: 1
              bldg_sf: 25
              yrblt: 4
              dist_ft: 250
        model:
          engine: lightgbm
          objective: mae
          seed: 20220117
          verbose: -1
          predictor:
            all:
            - meta_township_code
            - meta_nbhd_code
            - meta_tieback_proration_rate
            - char_yrblt
            - char_air
            - char_apts
            - char_attic_fnsh
            - char_attic_type
            - char_beds
            - char_bldg_sf
            - char_bsmt
            - char_bsmt_fin
            - char_ext_wall
            - char_fbath
            - char_frpl
            - char_gar1_area
            - char_gar1_att
            - char_gar1_cnst
            - char_gar1_size
            - char_hbath
            - char_land_sf
            - char_heat
            - char_ncu
            - char_porch
            - char_roof_cnst
            - char_rooms
            - char_tp_dsgn
            - char_tp_plan
            - char_type_resd
            - char_use
            - loc_longitude
            - loc_latitude
            - loc_cook_municipality_name
            - loc_env_flood_fema_sfha
            - loc_env_flood_fs_factor
            - loc_env_flood_fs_risk_direction
            - loc_env_ohare_noise_contour_no_buffer_bool
            - loc_school_elementary_district_geoid
            - loc_school_secondary_district_geoid
            - loc_school_unified_district_geoid
            - loc_tax_special_service_area_num
            - loc_access_cmap_walk_nta_score
            - loc_access_cmap_walk_total_score
            - loc_misc_subdivision_id
            - loc_misc_unincorporated_area_bool
            - prox_num_pin_in_half_mile
            - prox_num_bus_stop_in_half_mile
            - prox_num_foreclosure_per_1000_pin_past_5_years
            - prox_num_school_in_half_mile
            - prox_num_school_with_rating_in_half_mile
            - prox_avg_school_rating_in_half_mile
            - prox_nearest_bike_trail_dist_ft
            - prox_nearest_cemetery_dist_ft
            - prox_nearest_cta_route_dist_ft
            - prox_nearest_cta_stop_dist_ft
            - prox_nearest_hospital_dist_ft
            - prox_lake_michigan_dist_ft
            - prox_nearest_major_road_dist_ft
            - prox_nearest_metra_route_dist_ft
            - prox_nearest_metra_stop_dist_ft
            - prox_nearest_park_dist_ft
            - prox_nearest_railroad_dist_ft
            - prox_nearest_water_dist_ft
            - acs5_percent_age_children
            - acs5_percent_age_senior
            - acs5_median_age_total
            - acs5_percent_mobility_no_move
            - acs5_percent_mobility_moved_from_other_state
            - acs5_percent_household_family_married
            - acs5_percent_household_nonfamily_alone
            - acs5_percent_education_high_school
            - acs5_percent_education_bachelor
            - acs5_percent_education_graduate
            - acs5_percent_income_below_poverty_level
            - acs5_median_income_household_past_year
            - acs5_median_income_per_capita_past_year
            - acs5_percent_income_household_received_snap_past_year
            - acs5_percent_employment_unemployed
            - acs5_median_household_total_occupied_year_built
            - acs5_median_household_renter_occupied_gross_rent
            - acs5_median_household_owner_occupied_value
            - acs5_percent_household_owner_occupied
            - acs5_percent_household_total_occupied_w_sel_cond
            - acs5_percent_mobility_moved_in_county
            - other_ihs_avg_year_index
            - other_tax_bill_rate
            - other_school_district_elementary_avg_rating
            - other_school_district_secondary_avg_rating
            - time_sale_year
            - time_sale_day
            - time_sale_quarter_of_year
            - time_sale_day_of_year
            - ind_pin_is_multicard
            categorical:
            - meta_township_code
            - meta_nbhd_code
            - char_air
            - char_apts
            - char_attic_fnsh
            - char_attic_type
            - char_bsmt
            - char_bsmt_fin
            - char_ext_wall
            - char_gar1_area
            - char_gar1_att
            - char_gar1_cnst
            - char_gar1_size
            - char_heat
            - char_porch
            - char_roof_cnst
            - char_tp_dsgn
            - char_tp_plan
            - char_type_resd
            - char_use
            - loc_cook_municipality_name
            - loc_school_elementary_district_geoid
            - loc_school_secondary_district_geoid
            - loc_school_unified_district_geoid
            - loc_tax_special_service_area_num
            - loc_misc_subdivision_id
            - time_sale_quarter_of_year
            id:
            - meta_year
            - meta_pin
            - meta_class
            - meta_card_num
            - meta_sale_document_num
          parameter:
            num_iterations: 1000
            learning_rate: 0.1
            validation_prop: 0.1
            validation_metric: mae
            link_max_depth: true
          hyperparameter:
            default:
              stop_iter: 14
              num_leaves: 4270
              add_to_linked_depth: 2
              feature_fraction: 0.4120287037454545
              max_cat_threshold: 206
              min_data_per_group: 96
              lambda_l1: 0.48360347165103584
              max_depth: 14
              max_bin: 981
            range:
              stop_iter:
              - 5
              - 30
              num_leaves:
              - 500
              - 6000
              add_to_linked_depth:
              - 1
              - 3
              feature_fraction:
              - 0.3
              - 1.0
              max_cat_threshold:
              - 20
              - 250
              min_data_per_group:
              - 20
              - 250
              lambda_l1:
              - -3
              - 2
              max_depth:
              - 4
              - 16
              max_bin:
              - 50
              - 1200
        pv:
          multicard_yoy_cap: 2.0
          land_pct_of_total_cap: 0.5
          round_break:
          - 10000
          round_to_nearest:
          - 100
          - 500
          round_type: ceiling
        ratio_study:
          far_year: '2019'
          far_stage: board
          far_column: meta_2yr_pri_board_tot
          near_year: '2021'
          near_stage: mailed
          near_column: meta_mailed_tot
          num_quantile:
          - 3
          - 5
          - 10
        run_note: "MAE loss function with high iters. Stripped out hyperparams, add\
          \ day_ variables, remove tax_bill_total. Compare to agitated-maya-2022-02-25\n"
        run_type: full
        toggle:
          cv_enable: true
          upload_to_s3: true
    outs:
    - path: output/metadata/model_metadata.parquet
      md5: 8f11e6a97345cb32703e595c3a603f54
      size: 24509
    - path: output/timing/model_timing.parquet
      md5: be459668f7172bf62213119b9e973de7
      size: 5249
